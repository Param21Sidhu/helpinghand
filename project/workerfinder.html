<!DOCTYPE html>
<html lang="en">
<head>
     <!-- Required meta tags -->
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">
 
     <!-- Bootstrap CSS -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>


     <link rel="stylesheet" href="css/workerfinder.css">
     <script src="js/angular.min.js"></script>
     <script src="js/jquery-1.8.2.min.js"></script>
    <title>Document</title>
    <script>
         var mymodule=angular.module("mymodule",[]);
        var mycontroller=mymodule.controller("mycontroller",function($scope,$http){
       
            $scope.jsonAryCity;
        $scope.fetchAllCity=function(){
            var url="/fetchfindcities";
            $http.get(url).then(kuchfxgood,kuchfxbad);
    function kuchfxgood(response)
    {
        $scope.jsonAryCity=response.data;
    }
    function kuchfxbad(response)
    {
        alert(JSON.stringify(response.data));
    }
}   
       


$scope.jsonAryCategory;
        $scope.fetchAllCategory=function(){
            var url="/fetchfindcategory";
            $http.get(url).then(kuchfxgood,kuchfxbad);
    function kuchfxgood(response)
    {
        $scope.jsonAryCategory=response.data;
    }
    function kuchfxbad(response)
    {
        alert(JSON.stringify(response.data));
    }
}   
    




     $scope.dosearch=function(city)
     {
         //alert($scope.selcity);
         //alert($scope.selcategory);
         
$scope.jsonAryCityandcat;
            var url="/fetchfindcityandcat?x="+$scope.selcity+"&y="+$scope.selcategory;
            $http.get(url).then(kuchfxgood,kuchfxbad);
    function kuchfxgood(response)
    {
        //alert(JSON.stringify(response.data))
       $scope.jsonAryCityandcat=response.data;
    }
    function kuchfxbad(response)
    {
        alert(JSON.stringify(response.data));
    }
         
     }



     $scope.showone=function(index){
         
            alert(index);
        $scope.obj=$scope.jsonAryCityandcat[index];
        alert($scope.obj.Email);
     }
       
       
        });
    </script>
</head>
<body ng-app="mymodule"  ng-controller="mycontroller" ng-init="fetchAllCity();fetchAllCategory();">
     <div class="container">
         <div class="row">
             <div class="col-12 text-center">
                 <h3>Find Your Nearby Worker----</h3>
             </div>
         </div>
         <div class="row" id="r2">
            
             <div class="col-md-4" >
                <label for="txtcity" class="form-label">City</label>
               
                <select id="txtcity"  class="form-control" ng-model="selcity">
                    <option ng-repeat="obj in jsonAryCity" value="{{obj.City}}">{{obj.City}}</option>
                </select>

           
               
         
             </div>
             <div class="col-md-4">
                <label for="txtwork" class="form-label">Category</label>
               
                <select id="txtwork"  class="form-control" ng-model="selcategory" >
                    <option ng-repeat="obj in jsonAryCategory" value="{{obj.Category}}">{{obj.Category}}</option>
                </select>
             </div>
             <div class="col-md-3">
                <input class="btn btn-primary" type="button" value="Search" ng-click="dosearch(obj.City);">
             </div>


           
         </div>
         <div class="row" id="rowcards">
             <div class="col-md-4" ng-repeat="obj in jsonAryCityandcat">
                <div class="card" id="cards">
                    <img src="pics/{{obj.Profilepic}}" width="80px" height="240px" class="card-img-top" alt="...">
                    <div class="card-body">
                      <h5 class="card-title">{{obj.Name}}</h5>
                      <p class="card-text">{{obj.City}}</p>

               


                                            <!-- Button trigger modal -->
<button type="button" ng-click="showone($index)" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    For more details...
  </button>



                      <!-- Modal -->
 




  
                    </div>
                  </div>


             </div>
         </div>
     </div>







     <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Details About {{obj.Name}}</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div id="box">
    <table  width="460px">
    <tr>
        <td align="center">
            
                <font size="6px" color="green">ID PHOTO</font>
        </td>
        <td align="center"> <img src="pics/{{obj.Idpic}}" width="150px" height="180px"  alt="..."></td>
    </tr>
    <tr>
        <td align="center"> <font size="5px" color="green">Email</td>
            <td align="center">{{obj.Email}}</td>
    </tr>
    <tr>
        <td align="center"> <font size="5px" color="green">Experience of working</font></td>
        <td align="center">{{obj.Experience}}</td>
    </tr>
    
    <tr>
        <td align="center"> <font size="5px" color="green">Contact</td>
            <td align="center">{{obj.Contact}}</td>
    </tr>              
    <tr>
        <td align="center"> <font size="5px" color="green">Before-work</td>
            <td align="center">{{obj.Beforework}}</td>
    </tr>
    <tr>
        <td align="center"> <font size="5px" color="green">Shop</td>
            <td align="center">{{obj.Shop}}</td>
    </tr>
    <tr>
        <td align="center"> <font size="5px" color="green">Address</td>
            <td align="center">{{obj.Address}}</td>
    </tr>
    
                </table>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              
            </div>
          </div>
        </div>
      </div>
      
    








      
</body>
</html>